
SELECT * from wb_common.com_company

SELECT * from rps_old_maintain where orgid = 335


SELECT a.* from rps_old_item a
inner join rps_old_maintain b
on a.service_code = b.service_code
where b.orgid = 335


SELECT a.* from rps_old_part a
inner join rps_old_maintain b
on a.service_code = b.service_code
where b.orgid = 335


SELECT a.service_code, a.car_no, a.car_vin, b.full_name, c.name, c.mobile,
       a.enter_date, a.enter_kilometers,
       a.enter_oil_mass, a.mt_advisor, case when a.status = 0 then '草稿'
       when a.status = 1 then '施工中' else '完工' end as status,
       a.plan_finish_date, a.draw_out_report, a.is_settle, a.out_date, 
       a.bala_audit_sign, d.package_subtotal,  d.item_subtotal, d.part_subtotal, d.netin_amt
from rps_maintain a
inner join wb_common.com_guest b
on a.guest_id = b.id
inner join rpb_contactor c
on a.contactor_id = c.id
left join rps_settlement d
on a.id = d.service_id
where a.orgid = 335 and a.is_settle = 1 and a.is_disabled = 0




SELECT a.service_code, b.item_name, c.name, b.item_time, b.unit_price, b.amt, 
       b.rate, b.discount_amt, b.subtotal, b.workers, b.sale_man, b.remark
from rps_maintain a
inner join rps_item b
on a.id = b.service_id
left join rpb_business_type c
on b.service_type_id = c.id
where a.orgid = 335 and a.is_settle = 1 and a.is_disabled = 0



SELECT a.service_code, b.part_code, b.part_name, c.name, b.qty, 
       b.unit_price, b.amt, 
       b.rate, b.discount_amt, b.subtotal, b.sale_man, b.remark
from rps_maintain a
inner join rps_part b
on a.id = b.service_id
left join rpb_business_type c
on b.service_type_id = c.id
where a.orgid = 335 and a.is_settle = 1 and a.is_disabled = 0





