


1、比对进销存明细pj_invocing与出入库表的明细记录数是否一致

入库记录是否一致
SELECT count(1) 
from pj_invocing a
where dc = 1

SELECT count(1) 
from pj_store_invocing
where dc = 1

SELECT count(1) 
from pj_enter_detail_chk

查询入库部分中主表是否有问题，单号相同但是ID不同的数据（单号相同时ID应相同）
SELECT * 
from pj_invocing a
inner join pj_enter_main_chk b
on a.service_id = b.service_id
where a.dc = 1 and a.bill_main_id != b.id


查询入库部分中明细表是否有问题，单号相同但是ID不同的数据（单号相同时ID应相同）
SELECT a.bill_main_id, a.bill_detail_id, b.id, c.id 
from pj_invocing a
inner join pj_enter_main_chk b
on a.service_id = b.service_id and a.bill_main_id = b.id
inner join pj_enter_detail_chk c
on b.id = c.main_id and a.part_id = c.part_id and a.cost_price = c.enter_price and a.qty = c.enter_qty
where a.dc = 1 and a.bill_detail_id != c.id






出库记录是否一致
SELECT count(1) 
from pj_invocing a
where dc = -1

SELECT count(1) 
from pj_store_invocing
where dc = -1

SELECT count(1) 
from pj_out_detail_chk


SELECT * 
from pj_invocing a
inner join pj_out_main_chk b
on a.service_id = b.service_id
where a.dc = -1 and a.bill_main_id != b.id


查询出库部分中主表是否有问题，单号相同但是ID不同的数据（单号相同时ID应相同）
SELECT * 
from pj_invocing a
inner join pj_out_main_chk b
on a.service_id = b.service_id
where a.dc = -1 and a.bill_main_id != b.id


查询出库部分中明细表是否有问题，单号相同但是ID不同的数据（单号相同时ID应相同）
SELECT a.bill_main_id, a.bill_detail_id, b.id, c.id, a.qty, a.cost_price, c.sell_qty, c.enter_price
from pj_invocing a
inner join pj_out_main_chk b
on a.service_id = b.service_id and a.bill_main_id = b.id
inner join pj_out_detail_chk c
on b.id = c.main_id and a.part_id = c.part_id and a.cost_price = c.enter_price and a.qty = c.sell_qty
where a.dc = -1 and a.bill_detail_id != c.id





采购订单表  cloudPartPjPchsOrderMain.id   cloudPartPjPchsOrderDetail.id  dmsPartPjPchsOrderMain.id   dmsPartPjPchsOrderDetail.id
销售订单表  cloudPartPjSellOrderMain.id   cloudPartPjSellOrderDetail.id  dmsPartPjSellOrderMain.id   dmsPartPjSellOrderDetail.id
采购入库表  cloudPartPjEnterMain.id   cloudPartPjEnterDetail.id  
dmsPartPjEnterMain.id   dmsPartPjEnterDetail.id
销售出库表  cloudPartPjOutMain.id   cloudPartPjOutDetail.id  
dmsPartPjOutMain.id   dmsPartPjOutDetail.id
取对应ID的最大值，在后台表中插入数据







